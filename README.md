# 🚁 LOS 飛行訓練模擬器 Pro

Web-based 四軸飛行器目視飛行訓練模擬器。純瀏覽器運行，免安裝。

## 🎮 線上試玩

👉 **[點此開始飛行](https://m72900024.github.io/-Flight-Simulator-third-person-view/)**

---

## ✨ 功能特色

- 🌳 精緻 3D 場景（樹木、建築、H 降落場、圍欄、風向袋）
- 👀 第三人稱 LOS 目視飛行視角（模擬站在場地看飛機）
- ✈️ 4 種飛行模式（Angle / Horizon / Acro / Alt Hold）
- 🏆 8 個循序漸進訓練關卡
- 🎮 搖桿 + ⌨️ 鍵盤雙輸入支援
- 🔒 關卡解鎖系統 + 最佳成績記錄
- 💥 撞地回饋（紅閃 + 鏡頭抖動）
- ☀️ 即時陰影渲染

---

## 🕹️ 操作方式

### ⌨️ 鍵盤控制

| 按鍵 | 功能 |
|------|------|
| `W` / `S` | 油門升降 |
| `↑` / `↓` | 俯仰（前進 / 後退） |
| `←` / `→` | 橫滾（左右傾斜） |
| `A` / `D` | 轉向（Yaw） |
| `Space` | 解鎖 / 鎖定馬達 |
| `1` | Angle 模式（自穩） |
| `2` | Horizon 模式（半自穩） |
| `3` | Acro 模式（手動） |
| `4` | Alt Hold 模式（定高） |
| `R` | 重置無人機位置 |
| `ESC` | 返回關卡選擇 |
| `K` | 切換鍵盤/搖桿模式 |

### 🎮 搖桿控制

支援標準 Gamepad API 搖桿（如 RadioMaster、Xbox 手把等）。

- 進入設定畫面後自動偵測搖桿
- 可自訂通道映射（油門、轉向、俯仰、橫滾、解鎖、模式）
- 支援反轉設定
- 支援中點校正 + 端點校正（Min/Max）

---

## ✈️ 飛行模式說明

| 模式 | 按鍵 | 說明 | 適合對象 |
|------|------|------|----------|
| **Angle** | `1` | 自穩模式，鬆桿自動回正，最大傾角 55° | 🟢 新手 |
| **Horizon** | `2` | 混合模式，中間自穩、推到底變手動 | 🟡 進階 |
| **Acro** | `3` | 純角速度控制，無自動回正 | 🔴 高手 |
| **Alt Hold** | `4` | 定高模式，油門中位自動維持高度，姿態同 Angle | 🟢 最簡單 |

### Alt Hold 模式詳解

- 油門 40%~60%（中位）→ 自動維持當前高度
- 油門 > 60% → 爬升
- 油門 < 40% → 下降
- 俯仰/橫滾：同 Angle 模式（自穩）
- 最適合初學者練習方向控制

---

## 🏆 關卡說明

| 關卡 | 名稱 | 任務目標 |
|------|------|----------|
| 1 | 起飛定高 | 起飛並維持在 2~3m 高度 3 秒 |
| 2 | 定點懸停 | 在綠色方框內穩定懸停 3 秒 |
| 3 | 前後平移 | 飛到前方標記點再飛回來 |
| 4 | 左右平移 | 依序飛到左方與右方標記點 |
| 5 | 矩形航線 | 依序飛過 4 個航點，完成矩形路線 |
| 6 | 穿越拱門 | 穿越前方拱門 |
| 7 | 8 字飛行 | 繞兩根柱子畫 8 字形航線 |
| 8 | 綜合挑戰 | 穿門 + 航點 + 返回降落場 |

- 過關後自動解鎖下一關
- 成績（秒數）自動記錄到瀏覽器 localStorage

---

## 🛠️ 技術架構

- **3D 引擎**: [Three.js](https://threejs.org/) r128（CDN 載入）
- **語言**: JavaScript ES6 Modules
- **建置工具**: 無需 npm / bundler，直接開啟 `index.html`
- **部署**: GitHub Pages

### 檔案結構

```
├── index.html              # 主頁面 + UI 樣式
└── src/
    ├── Config.js           # 物理參數、飛行模式、關卡定義
    ├── Input.js            # 鍵盤/搖桿輸入控制器
    ├── Physics.js          # 物理引擎（推力、重力、碰撞、姿態）
    ├── Scene.js            # 3D 場景（環境、無人機模型、攝影機）
    ├── LevelManager.js     # 關卡管理（目標、判定、解鎖）
    └── main.js             # 主程式（遊戲迴圈、UI 更新）
```

### 物理模擬

- 模擬 5 吋 FPV 無人機（600g）
- 二次方空氣阻力
- Betaflight 風格 Rates（含 SuperRate）
- 油門指數曲線（Expo）
- 地面碰撞（彈跳 + 隨機旋轉）

---

## 📝 更新日誌

### v2.0（2026-03-01）
- 🌳 精緻場景升級（樹木、建築、降落場、圍欄、風向袋）
- ☀️ PCFSoft 陰影系統
- 🚁 四軸放大 3 倍，清楚可見
- 👀 固定 LOS 第三人稱視角
- 🏆 8 個循序漸進關卡
- 📊 關卡選擇畫面 + 解鎖系統 + 最佳成績
- ✈️ 新增 Alt Hold 定高飛行模式
- 💥 撞地回饋效果（紅閃 + 攝影機抖動）
- ↕️ 修正俯仰方向

### v1.0
- 基礎 LOS 飛行模擬
- Acro / Angle / Horizon 三種模式
- 搖桿 + 鍵盤輸入
- 2 個基礎關卡

---

## 📄 授權

MIT License
